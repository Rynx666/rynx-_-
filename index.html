<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VELN</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–π loader –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π -->
  <div id="global-loader" class="global-loader">
    <div class="loader-spinner"></div>
  </div>

  <!-- –ù–æ–≤—ã–π –≤–µ—Ä—Ö: –±–æ–ª—å—à–æ–π –ª–æ–≥–æ—Ç–∏–ø + –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
  <div class="veln-header-main">
    <div class="veln-logo-block">
      <img src="pictures/VELN_Logo/VELN_Logo.png" alt="VELN Logo" class="veln-logo-img">
    </div>
    <button class="profile-avatar-btn" id="profile-menu-btn">
      <img src="" alt="User" class="profile-avatar-img" id="profile-avatar-img">
    </button>
  </div>

  <!-- –°—á–µ—Ç—á–∏–∫ –æ—á–∫–æ–≤ -->
  <div class="score-counter-block">
    <span class="counter-label">–û—á–∫–æ–≤:</span>
    <span id="balance" class="counter-value">0</span>
  </div>

  <!-- –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è -->
  <div class="profile-menu" id="profile-menu">
    <button class="profile-menu-close" id="profile-menu-close">&times;</button>
    <ul>
      <li><button class="profile-menu-item" data-action="inventory">üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button></li>
      <li><button class="profile-menu-item" data-action="open-case">üéÅ –û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å</button></li>
      <li><button class="profile-menu-item" data-action="top">üèÜ –¢–æ–ø</button></li>
      <li><button class="profile-menu-item" data-action="market">üõí –†—ã–Ω–æ–∫</button></li>
    </ul>
  </div>
  <div class="profile-menu-backdrop" id="profile-menu-backdrop"></div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –≤—ã–ø–∞–¥–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–∞ -->
  <div id="drop-modal" class="drop-modal modal hidden">
    <div class="drop-content" id="drop-content"></div>
  </div>

  <!-- –ö–µ–π—Å—ã –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä sheet -->
  <div id="case-preview-sheet" class="case-preview-sheet sheet">
    <div class="case-preview-header">
      <div class="case-preview-grabber"></div>
      <button id="case-preview-close" class="case-preview-close sheet-close">&times;</button>
      <button id="case-preview-open" class="case-preview-open">–û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å</button>
    </div>
    <div id="case-preview-table" class="case-preview-table"></div>
  </div>
  <div id="sheet-backdrop" class="sheet-backdrop"></div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–≥–∞ -->
  <div id="add-friend-modal" class="modal hidden">
    <div class="modal-content card">
      <button class="modal-close" id="add-friend-close">&times;</button>
      <h3>–î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞</h3>
      <input type="text" id="friend-username-input" placeholder="Username –∏–ª–∏ ID" class="input">
      <button class="veln-main-btn" id="add-friend-confirm">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
      <div id="add-friend-message"></div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–¥–∞—Ä–∫–∞ -->
  <div id="gift-modal" class="modal hidden">
    <div class="modal-content card">
      <button class="modal-close" id="gift-modal-close">&times;</button>
      <h3>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫</h3>
      <div id="gift-modal-friend"></div>
      <div class="gift-type-selector">
        <button class="gift-type-btn active" data-type="coin">–ú–æ–Ω–µ—Ç—ã</button>
        <button class="gift-type-btn" data-type="item">–ü—Ä–µ–¥–º–µ—Ç</button>
      </div>
      <div id="gift-modal-form-coin" class="gift-form-block">
        <input type="number" id="gift-coin-amount" placeholder="–°–∫–æ–ª—å–∫–æ –º–æ–Ω–µ—Ç?" min="1" class="input" />
        <button class="veln-main-btn" id="gift-send-coin">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—ã</button>
      </div>
      <div id="gift-modal-form-item" class="gift-form-block hidden">
        <select id="gift-item-select" class="input"></select>
        <button class="veln-main-btn" id="gift-send-item">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button>
      </div>
      <div id="gift-modal-message" style="margin-top:10px; color:var(--accent2);"></div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–¥–º–µ—Ç–∞ –Ω–∞ —Ä—ã–Ω–∫–µ -->
  <div id="sell-modal" class="modal hidden">
    <div class="modal-content card">
      <button class="modal-close" id="sell-modal-close">&times;</button>
      <h3 style="color:#f7ff00;">–í—ã—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</h3>
      <select id="sell-item-select" class="input"></select>
      <input type="number" id="sell-price-input" placeholder="–¶–µ–Ω–∞ –≤ VC" min="1" class="input"/>
      <button class="veln-main-btn" id="confirm-sell-btn">–í—ã—Å—Ç–∞–≤–∏—Ç—å</button>
      <div id="sell-modal-msg" style="color:var(--accent2);margin-top:10px;"></div>
    </div>
  </div>

  <!-- –¢–∞–±—ã –∏ –∫–æ–Ω—Ç–µ–Ω—Ç (—Å–∫—Ä—ã—Ç—ã, –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ–Ω—é) -->
  <div class="veln-tabs" id="veln-tabs" style="display:none;">
    <div id="tab-inventory" class="tab-content hidden card">
      <div id="inventory" class="inventory-list"></div>
    </div>
    <div id="tab-top" class="tab-content hidden card">
      <div class="top-tabs">
        <button class="top-tab-btn active" data-top-tab="balance">–¢–æ–ø –ø–æ –æ—á–∫–∞–º</button>
        <button class="top-tab-btn" data-top-tab="vc">–¢–æ–ø –ø–æ VELN COIN</button>
      </div>
      <ul id="top-list-balance" class="top-list"></ul>
      <ul id="top-list-vc" class="top-list hidden"></ul>
    </div>
    <!-- –î—Ä—É–∑—å—è -->
    <div id="tab-friends" class="tab-content hidden card">
      <div class="friends-header">
        <button class="veln-main-btn" id="add-friend-btn">–î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞</button>
        <button class="veln-main-btn" id="show-gifts-btn" style="margin-left:10px;">–ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤</button>
      </div>
      <!-- –ó–∞—è–≤–∫–∏ –≤ –¥—Ä—É–∑—å—è -->
      <div class="friends-requests-block" id="friends-requests-block"></div>
      <ul id="friends-list" class="friends-list"></ul>
      <!-- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤ -->
      <div id="gifts-history-block" class="gifts-history-block hidden" style="position:relative;">
        <button id="close-gifts-history" class="modal-close" style="position:absolute;top:10px;right:10px;">&times;</button>
        <!-- –°—é–¥–∞ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤ -->
      </div>
    </div>
    <!-- –†—ã–Ω–æ–∫ -->
    <div id="tab-market" class="tab-content hidden card">
      <h3 class="market-title">
        <span style="color:#f7ff00;">üõí –û–Ω–ª–∞–π–Ω-—Ä—ã–Ω–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</span>
      </h3>
      <div class="market-actions">
        <button id="show-sell-modal" class="veln-main-btn market-sell-btn">+ –í—ã—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∂—É</button>
      </div>
      <div id="market-list"></div>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    // –ü—Ä–æ—Ñ–∏–ª—å-–º–µ–Ω—é: –∞–≤–∞—Ç–∞—Ä–∫–∞ –∏ –≤—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é
    document.addEventListener("DOMContentLoaded", () => {
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º telegram –∞–≤–∞—Ç–∞—Ä–∫—É, –µ—Å–ª–∏ –µ—Å—Ç—å
      if (window.Telegram && Telegram.WebApp && Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) {
        const user = Telegram.WebApp.initDataUnsafe.user;
        const photo = user.photo_url || "https://t.me/i/userpic/320/" + (user.username || "") + ".jpg";
        document.getElementById("profile-avatar-img").src = photo;
      }
      // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é
      document.getElementById("profile-menu-btn").onclick = () => {
        document.getElementById("profile-menu").classList.add("active");
        document.getElementById("profile-menu-backdrop").classList.add("active");
      };
      document.getElementById("profile-menu-close").onclick = () => {
        document.getElementById("profile-menu").classList.remove("active");
        document.getElementById("profile-menu-backdrop").classList.remove("active");
      };
      document.getElementById("profile-menu-backdrop").onclick = () => {
        document.getElementById("profile-menu").classList.remove("active");
        document.getElementById("profile-menu-backdrop").classList.remove("active");
      };
      // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ–Ω—é
      document.querySelectorAll('.profile-menu-item').forEach(btn => {
        btn.onclick = () => {
          const action = btn.dataset.action;
          // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–π —Ç–∞–± –∏ —Å–∫—Ä—ã—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ, –ø–æ–∫–∞–∑–∞—Ç—å –±–ª–æ–∫ .veln-tabs
          document.getElementById("veln-tabs").style.display = "block";
          document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add("hidden"));
          if (action === "inventory") {
            document.getElementById("tab-inventory").classList.remove("hidden");
          } else if (action === "open-case") {
            // –û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å: –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–µ–π—Å–∞ (—Å—Ç–∞—Ä—ã–π open-case-btn)
            document.getElementById("case-preview-sheet").classList.add("active");
            document.getElementById("sheet-backdrop").classList.add("active");
          } else if (action === "top") {
            document.getElementById("tab-top").classList.remove("hidden");
          } else if (action === "market") {
            document.getElementById("tab-market").classList.remove("hidden");
          }
          // –°–∫—Ä—ã—Ç—å –º–µ–Ω—é –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
          document.getElementById("profile-menu").classList.remove("active");
          document.getElementById("profile-menu-backdrop").classList.remove("active");
        };
      });
    });
  </script>
</body>
</html>